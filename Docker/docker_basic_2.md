# 1. PostgreSQL 컨테이너로 배포하기

image 목록에 <none>이 있는데, 이것의 의미는 똑같은 것을 다운받으면 이전 것은 <none>이 된다. 

이를 제거하는 방법은 `docker image rm <IMAGE ID>` 다. 



컨테이너 내부로 들어가기 
`docker exec -it <Container ID> /bin/bash`
- 그래서 이 내부에서 명령어를 잘못 입력하면 컨테이너에서 나갔다가 Kill하면 된다. 

`psql -U postgres` 를 의미한다. 


`\dt`: 테이블 조회

postgresql 종료 명령어: `\q`



<br>

---

# 2. 도커 볼륨(docker volume)

도커의 컨테이너에 있는 데이터를 보관하기 위해서 사용하는 것

컨테이너를 내렸다가 다시 들어가면 삭제한 게 아니므로 데이터가 그대로 있지만, 만약 컨테이너를 삭제하면 데이터까지 다 삭제하는 것 

도커에서는 볼륨을 생성하여 사용하기를 추천한다. 

### 1. 로컬 경로와 연결

연결할 호스트 경로 확인

- /work/test 경로를 도커 컨테이너를 연결해볼 것이다.
    -그러면 while_loop.py가 컨테이너에도 존재할 것이다. 


그리고 inside를 생성하면 컨테이너 밖에서도 볼 수 있는 걸 확인할 수 있다.


지금은 컨테이너 내부에서 삭제하면 로컬에서도 삭제되므로, 작업이 위험하다. 

### 2. 도커 볼륨 생성

첫 번째, 볼륨을 ec2에서 생성한다.

Mountpoint: 데이터가 저장되는 경로를 의미 




<br>

----

# 3. 도커로 장고, nginx, PostgreSQL 함께 배포하기

- psql-test에는 db이기 때문에 volume이 추가된 걸 알 수 있다. 


- 만약 용량이 부족하다는 error가 뜰 경우 `docker system prune --volumes` 명령어를 상용해보자. 

- 컨테이너가 잘못되었는지 File system이 잘못되었는지 구분해야 한다.


db를 컨테이너에 띄어서 관리하는가, 아니면 쌩 서버에 관리하는가 는 호불호가 갈린다. 

왜냐하면 컨테이너의 기본이 지워져도 상관없다는 전제이기 때문에, db는 지워지면 안되기 때문에 컨테이너에 사용되지 않는다. 

AWS의 RDS를 컨테이너에 연결하는 건 강사님이 해보지는 않았지만, 될 것 같다. 

- 기술의 후발주자들은 기존 서비스가 제공하는 걸 안쓰면 경쟁에서 밀리기 때문에 될 것이다.
- 그리고, 후발주자이기에 구글링 했을 때 자원이 별로 없다. 


gunicorn을 사용한 이유는 
wsgi를 쓰면 마이크로 관리가 가능하다. 하지만 구니콘은 대략적으로 관리되기 때문이다.
그래서 극도로 속도를 관리할려면 wsgi를 쓴다. 

또한, 옛날에는 아파치를 썼지만 요즘은 성능이 많이 좋아져서 NGINX를 사용한다. 

코테는 잘할려고 하기보다는 통과할려고만 하자. 



<br>

---

# 4. 못다한 이야기

## 4.1 docker swarm

도커 스웜보다 더 대단한 쿠버네티스가 나타났기 때문에, 듣지 못 했다. 

## 4.2 Kubernetes(k8s)

도커는 컨테이너 기준으로, 쿠버네티스는 파드를 기준으로 설명한다. 

마스터 노드가 워커 노드를 조종한다. 